---
import Layout from '../../layouts/Layout.astro';
import CarouselComponent from '../../components/Carousel.astro';
import { getAllArticles, getExcerpt } from '../../lib/datocms';
import heroGraphic from '../../assets/background.svg';
import placeholder from '../../assets/images/placeholder.png';

const imageSlides = [
	{
		title: 'Motion-led experiments',
		description: 'Rapid prototypes blending performance and animation for immersive product feel.',
		image: heroGraphic,
		alt: 'Abstract background graphic with gradients.'
	},
	{
		title: 'Design systems at scale',
		description: 'Build component libraries that keep teams shipping consistently.',
		image: placeholder,
		alt: 'Placeholder texture for design systems.'
	},
	{
		title: 'Immersive storytelling',
		description: 'Craft narratives that move as fast as your users scroll.',
		image: heroGraphic,
		alt: 'Abstract storytelling graphic.'
	},
	{
		title: 'Immersive storytelling',
		description: 'Craft narratives that move as fast as your users scroll.',
		image: heroGraphic,
		alt: 'Abstract storytelling graphic.'
	},
	{
		title: 'Immersive storytelling',
		description: 'Craft narratives that move as fast as your users scroll.',
		image: heroGraphic,
		alt: 'Abstract storytelling graphic.'
	}
];

const articles = await getAllArticles();

const blogSlides = (articles ?? [])
	.filter((article) => article?.slug && article?.featuredImage?.responsiveImage?.src)
	.sort((a, b) => {
		const dateA = a?.articleDisplayDate ? new Date(a.articleDisplayDate).getTime() : 0;
		const dateB = b?.articleDisplayDate ? new Date(b.articleDisplayDate).getTime() : 0;
		return dateB - dateA;
	})
	.slice(0, 5)
		.map((article) => {
			const responsiveImage = article?.featuredImage?.responsiveImage;
			const rawDescription = getExcerpt(article?._seoMetaTags ?? []);
			const description = rawDescription || 'Read the full story on the blog.';
			const altText = responsiveImage?.alt || article?.featuredImage?.title || article?.title || 'Blog article image';
			return {
				title: article?.title ?? 'Untitled article',
				description,
				image: responsiveImage?.src as string,
				alt: altText,
				url: `/blog/${article?.slug}`
			};
		});
---

<Layout title='Carousel Demo' description='Development showcase for the Carousel component'>
	<section class="main-frame">
		<h1>Carousel component playground</h1>
		<p>These demos verify Swiper integration, accessibility, and reduced-motion fallbacks.</p>

		<CarouselComponent
			heading='Selected work'
			subheading='A rotating glimpse at current initiatives'
			slides={imageSlides}
			showArrows
			showPagination
			centered
			loop
			autoplayMs={6000}
			spaceBetween={24}
			responsive={{
				"768": { "slidesPerView": 1 },
				"1024": { "slidesPerView": 1.5, "spaceBetween": 16 },
				"1440": { "slidesPerView": 1.5, "spaceBetween": 16 }
			}}
		/>

		<CarouselComponent
			heading='Latest from the blog'
			subheading='Fresh insights delivered as a carousel'
			slides={blogSlides}
			showArrows
			centered
			loop
			showPagination
			spaceBetween={24}
			responsive={{
				"768": { "slidesPerView": 1 },
				"1024": { "slidesPerView": 1.5, "spaceBetween": 16 },
				"1440": { "slidesPerView": 1.5, "spaceBetween": 24 }
			}}
		/>

		<CarouselComponent showPagination={false} heading='Text-only stories'>
			<div class="swiper-slide">
				<h3 class="carousel__slide-title">Workflow automation</h3>
				<p class="carousel__slide-text">
					Bring repeatable creative tasks into orchestrated flows so teams focus on impact.
				</p>
			</div>
			<div class="swiper-slide">
				<h3 class="carousel__slide-title">Product strategy</h3>
				<p class="carousel__slide-text">
					Translate research insights into tangible product moves that feel inevitable.
				</p>
			</div>
			<div class="swiper-slide">
				<h3 class="carousel__slide-title">Sound design</h3>
				<p class="carousel__slide-text">
					Pair interfaces with subtle audio queues that respect accessibility and delight.
				</p>
			</div>
		</CarouselComponent>
	</section>
</Layout>
